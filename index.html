<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Tim Hortons Density</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}
</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


</head>

<body>
<!--
%\VignetteEngine{knitr}
%\VignetteIndexEntry{Tim Horton's Density in Canada}
-->

<pre><code class="r">options(stringsAsFactors = F)
require(timmysDensity)
require(plyr)
require(maps)
require(ggplot2)
require(geosphere)
</code></pre>

<h1>Tim Hortons Density</h1>

<p>Inspired by this <a href="">post</a>, I wanted to examine the locations and density of Tim Hortons restaurants in Canada. Using Stats Canada data, each census tract is queried on Foursquare for Tims locations.</p>

<h2>Statistics Canada Census Data</h2>

<p>The actual Statistics Canada data at the dissemination block level can be downloaded from <a href="http://www.data.gc.ca/default.asp?lang=En&amp;n=5175A6F0-1&amp;xsl=datacataloguerecord&amp;metaxsl=datacataloguerecord&amp;formid=C87D5FDD-00E6-41A0-B5BA-E8E41B521ED0">here</a>. You will want to download the Excel format, read it, and then save it as either tab-delimited or CSV using a non-standard delimiter, I used a semi-colon (;).</p>

<pre><code class="r">censusData &lt;- read.table(&quot;../timmysData/2011_92-151_XBB_XLSX.csv&quot;, header = F, 
    sep = &quot;;&quot;, quote = &quot;&quot;)
censusData &lt;- censusData[, 1:17]
names(censusData) &lt;- c(&quot;DBuid&quot;, &quot;DBpop2011&quot;, &quot;DBtdwell2011&quot;, &quot;DBurdwell2011&quot;, 
    &quot;DBarea&quot;, &quot;DB_ir2011&quot;, &quot;DAuid&quot;, &quot;DAlamx&quot;, &quot;DAlamy&quot;, &quot;DAlat&quot;, &quot;DAlong&quot;, &quot;PRuid&quot;, 
    &quot;PRname&quot;, &quot;PRename&quot;, &quot;PRfname&quot;, &quot;PReabbr&quot;, &quot;PRfabbr&quot;)
censusData$DBpop2011 &lt;- as.numeric(censusData$DBpop2011)
censusData$DBpop2011[is.na(censusData$DBpop2011)] &lt;- 0

censusData$DBtdwell2011 &lt;- as.numeric(censusData$DBtdwell2011)
censusData$DBtdwell2011[is.na(censusData$DBtdwell2011)] &lt;- 0
</code></pre>

<p>From this data we get block level:</p>

<ul>
<li>populations (DBpop2011)</li>
<li>total private dwellings (DBtdwell2011)</li>
<li>privale dwellings occupied by usual residents (DBurdwell2011)</li>
<li>block land area (DBarea)</li>
<li>dissemination area id (DAuid)</li>
<li>representative point x coordinate in Lambert projection (DAlamx)</li>
<li>rep. point y coordinate in Lambert projection (DAlamy)</li>
<li>rep. point latitude (DAlat)</li>
<li>rep. point longitude (DAlong)</li>
</ul>

<p>This should be everything we need to do the investigation we want.</p>

<h2>Dissemination Area Long. and Lat.</h2>

<p>We need to find the unique dissemination areas, and get out their latitudes and longitudes for querying in other databases. Note that the longitude and latitude provided here actually are weighted representative locations based on population. However, given the size of them, I don&#39;t think using them will be a problem for <code>Foursquare</code>. Because areas are what we have location data for, we will summarize everything at the area level, summing the population counts for all the blocks within an area.</p>

<pre><code class="r">uniqAreas &lt;- unique(censusData$DAuid)

summarizeArea &lt;- function(areaID) {
    areaData &lt;- censusData[(censusData$DAuid == areaID), ]
    outData &lt;- data.frame(uid = areaID, lamx = areaData[1, &quot;DAlamx&quot;], lamy = areaData[1, 
        &quot;DAlamy&quot;], lat = areaData[1, &quot;DAlat&quot;], long = areaData[1, &quot;DAlong&quot;], 
        pop = sum(areaData[, &quot;DBpop2011&quot;]), dwell = sum(areaData[, &quot;DBtdwell2011&quot;]), 
        prov = areaData[1, &quot;PRename&quot;])
    return(outData)
}
areaData &lt;- adply(uniqAreas, 1, summarizeArea)
.sessionInfo &lt;- sessionInfo()
.timedate &lt;- Sys.time()
write.table(areaData, file = &quot;../timmysData/areaData.txt&quot;, sep = &quot;\t&quot;, row.names = F, 
    col.names = T)
save(areaData, .sessionInfo, .timedate, file = &quot;../timmysData/areaDataFile.RData&quot;, 
    compress = &quot;xz&quot;)
</code></pre>

<h2>Run queries on Foursquare</h2>

<h3>Load up the data and verify what we have.</h3>

<pre><code class="r">load(&quot;../timmysData/areaDataFile.RData&quot;)
head(areaData)
</code></pre>

<h3>Generate queries and run</h3>

<p>For each dissemination area (DA), we are going to use as the location for the query the latitude and longitude of each DA, as well as the search string &ldquo;tim horton&rdquo;. </p>

<p>Because Foursquare limits the number of userless requests to <a href="https://developer.foursquare.com/overview/ratelimits">5000 / hr</a>. To make sure we stay under this limit, we will divide up the data into <strong>blocks</strong> of 5000.</p>

<pre><code class="r">runQueries(areaData, idFile = &quot;../timmysData/clientid.txt&quot;, secretFile = &quot;../timmysData/clientsecret.txt&quot;, 
    outFile = &quot;../timmysData/timmysLocs2.txt&quot;)
</code></pre>

<h3>Clean up the results</h3>

<p>Due to the small size of the DAs, we have a lot of duplicate entries. Now lets remove all the duplicate entries.</p>

<pre><code class="r">cleanUpResults(&quot;../timmysData/timmysLocs2.txt&quot;)
</code></pre>

<h3>Visualize Locations</h3>

<p>First lets read in the data and make sure that we have Tims locations.</p>

<pre><code class="r"># read in and clean up the data
timsLocs &lt;- scan(file = &quot;../timmysData/timmysLocs2.txt&quot;, what = character(), 
    sep = &quot;\n&quot;)
timsLocs &lt;- strsplit(timsLocs, &quot;:&quot;)

timsName &lt;- sapply(timsLocs, function(x) {
    x[1]
})
timsLat &lt;- sapply(timsLocs, function(x) {
    x[2]
})
timsLong &lt;- sapply(timsLocs, function(x) {
    x[3]
})

locData &lt;- data.frame(description = timsName, lat = as.numeric(timsLat), long = as.numeric(timsLong))
hasNA &lt;- is.na(locData[, &quot;lat&quot;]) | is.na(locData[, &quot;long&quot;])
locData &lt;- locData[!(hasNA), ]

timsStr &lt;- c(&quot;tim hortons&quot;, &quot;tim horton&#39;s&quot;)

hasTims &lt;- (grepl(timsStr[1], locData$description, ignore.case = T)) | (grepl(timsStr[2], 
    locData$description, ignore.case = T))

locData &lt;- locData[hasTims, ]
timsLocs &lt;- locData
rm(timsName, timsLat, timsLong, hasNA, locData, hasTims, timsStr)
.timedate &lt;- Sys.time()
.sessionInfo &lt;- sessionInfo()
save(timsLocs, .timedate, .sessionInfo, file = &quot;../timmysData/timsLocs.RData&quot;, 
    compress = &quot;xz&quot;)
</code></pre>

<p>Lets actually put these on a map.</p>

<pre><code class="r">data(timsLocs)
data(areaDataFile)
canada &lt;- map_data(&quot;world&quot;, &quot;canada&quot;)

p &lt;- ggplot(legend = FALSE) + geom_polygon(data = canada, aes(x = long, y = lat, 
    group = group)) + theme(panel.background = element_blank()) + theme(panel.grid.major = element_blank()) + 
    theme(panel.grid.minor = element_blank()) + theme(axis.text.x = element_blank(), 
    axis.text.y = element_blank()) + theme(axis.ticks = element_blank()) + xlab(&quot;&quot;) + 
    ylab(&quot;&quot;)

sp &lt;- timsLocs[1, c(&quot;lat&quot;, &quot;long&quot;)]

p2 &lt;- p + geom_point(data = timsLocs[, c(&quot;lat&quot;, &quot;long&quot;)], aes(x = long, y = lat), 
    colour = &quot;green&quot;, size = 1, alpha = 0.5)

print(p2)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk mapIt"/> </p>

<p>And now lets also determine how far particular percentages of the population are from a Timmys.</p>

<pre><code class="r">queryLocs &lt;- matrix(c(timsLocs$long, timsLocs$lat), nrow = nrow(timsLocs), ncol = 2, 
    byrow = F)  # these are the tims locations
distLocs &lt;- matrix(c(areaData$long, areaData$lat), nrow = nrow(areaData), ncol = 2, 
    byrow = F)  # the census centers
allDists &lt;- apply(queryLocs, 1, function(x) {
    min(distHaversine(x, distLocs))  # only need the minimum value to determine
})
</code></pre>

<p>From the <code>allDists</code> variable above, we can determine that the maximum distance any census dissemination area (DA) is from a Tim Hortons is 51.5 km (31.9815 miles). This is based on distances calculated &ldquo;as the crow flies&rdquo;, but still, that is pretty close. Assuming roads, the furthest a Canadian should have to travel is less than an hour to get their Timmys fix. </p>

<pre><code class="r">totPopulation &lt;- sum(areaData$pop, na.rm = T)
lessDist &lt;- seq(50, 51.6 * 1000, 50)  # distances are in meters, so multiply by 1000 to get reasonable km

percPop &lt;- sapply(lessDist, function(inDist) {
    isLess &lt;- allDists &lt; inDist
    sum(areaData$pop[isLess], na.rm = T)/totPopulation * 100
})

plotDistPerc &lt;- data.frame(distance = lessDist, population = percPop, logDist = log10(lessDist))
ggplot(plotDistPerc, aes(x = logDist, y = population)) + geom_point()
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAACBFBMVEUAAAADAwMGBgYHBwcJCQkODg4PDw8QEBARERESEhITExMVFRUWFhYXFxcYGBgZGRkdHR0fHx8hISEiIiIlJSUmJiYqKiosLCwtLS0uLi4vLy86Ojo8PDxDQ0NERERHR0dKSkpMTExNTU1OTk5PT09TU1NVVVVYWFhZWVlcXFxdXV1eXl5fX19gYGBiYmJjY2NkZGRlZWVmZmZpaWl1dXV3d3d5eXl7e3t8fHx9fX1/f3+BgYGCgoKEhISGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+RkZGUlJSVlZWWlpaXl5eYmJiZmZmbm5ucnJydnZ2enp6fn5+goKChoaGjo6OkpKSlpaWmpqanp6epqamqqqqrq6usrKytra2urq6vr6+wsLCxsbGysrKzs7O0tLS1tbW2tra3t7e4uLi5ubm7u7u8vLy9vb2+vr6/v7/AwMDBwcHCwsLDw8PExMTFxcXIyMjKysrLy8vMzMzNzc3Ozs7Q0NDR0dHS0tLT09PU1NTV1dXW1tbX19fY2NjZ2dna2trb29vc3Nzd3d3e3t7f39/g4ODh4eHi4uLk5OTl5eXm5ubn5+fo6Ojp6enq6urr6+vs7Ozt7e3u7u7v7+/w8PDx8fHy8vLz8/P09PT19fX29vb39/f4+Pj5+fn6+vr7+/v8/Pz9/f3+/v7///8QWdH/AAAACXBIWXMAAAsSAAALEgHS3X78AAAPvElEQVR4nO3diX8cZR3H8UUQoUDFW0AUFI8WhIIiGgtUaAtdpAeWAIpKOERRwQrSSqpyWJAWlG1zbtvsZhPaTZ5/0j2a/hKSnZnv8yQ7szOfz+vFZhM6s7/knZmd7FlyVMhKaQ9A6QR8QQO+oAFf0IAvaMAXNOALGvAFDfiCBnxBA76gAV/QgC9oGnyj6l+9HrBwt9Ong1exDlNUw6eYraUwRAj8TMW/Wi1g4W5j48GrqIV8C93Gx4JXUT8bvIqJU+oSwAcGvBbwFvBawFvAi1MAD7xnwGsBbwGvBbwFvDgF8MB7BrwW8BbwWsBbwItTAA+8Z8BrAW8BrwW8tWHw53e1nIf3D890ToC38g3/zu4h50aOuCMjnRPgrXzDLy604HfVXG135wR4KyvwpajWWCLhrt614Lc3XXN756T1+d+ef/75N2f9O3cuYOFujUbwKs7nYYpI8m6rF0r8mLsW/M66q+/snLQ+/+drr7323ln/5ucDFu5WqwWv4uPBniIBebfVi04J8M+MuqMjnRN29VY6u/rE5Ouxq595YvjJmc4J8Fa/4T2M1ywp/FoBX+kvfG9sbsARpxgc+OjtG3hxigGBj92nAy9OMRjw8dfiwItTDAB8okM34MUpsg2f/HgdeHGKzMKLf6UBL06ROfief7BFB7w4RWbge4AnUq8AL0+ROnwUeDLzTsCLU6QIH0Oe2LwT8OIUfYaPw5bBlwJenGJD4ZMwh3lfDHhxio2Al7zb5Bl+6BXwPVsOL4IvBbxWduA171V7deC1MgGffLvuHfBaacOHWK8IeK004deJvBvwWunBrxP4UsBrpQO/Cj0jT6hQlwBeavWWnpVn0qhLAC+01s4deK2Bg+91nQ681oDB9z6SA15rkOAjj9+B1xog+Og/24DXGhT42L/VgdcaDPgEN9EArzUI8IlumQNeK/vwCW+QBV4r6/CJb4cHXivT8Mq9L8BrZRleYAdeLcPwCjvwatmFl9iBV8sovKheAV4tk/DaTr4b8FpZhPdxB14sg/Be7sCLZQ/eR70CvFo24T1WAbxW5uD9tnfg1bIG78kOvFrG4H23d+DVMgXveVzXCXitzMH7rgJ4rQzBh2zvBYWf9K/RCFi42/R08Coas5OTXXf/KaaCp5irB6+iqk4xFgR/0r9aLWDhbuPjwauot6bouPuvYiJ8itmQH2S3yTFxgcLv6sP285WC7uoDJs0SfNAqgNcC3gJea73gw1YBvFYm4IM39wrwasBbwGsBbwEvtQ7uwIulD9/e3NN/o4J2wGsBbwGfPOALCt+Sz8B70rQDXisE/sLxPPDA+wa8FvAW8FpB1/Hdv+CBLxS83W4DfJHglz30AnjgfQNei129BbxW2m9G1A14rbTgV94TCzzwvgGvBbwFvBbwFvDiFMAXAn7VQ62ALwT86sdWAg+8b8BrpbSr/+QUwBcCfvUUwOcefs3H0AOfe/i1nzQDPPC+Aa/Frt4CXouDOwt4cQrggfcMeC3gLeC1gLeAX6ver38AfN7he8gDD7xvwGsBbwGvxcGdBbw4BfDAe1YA+HK5fJ9r3l8uHwLeKgC8c9Xfu6kRtvgVFQL+hbPuvT33Pbr0thaDAB/92pXAJ4Kfesm5E6/PH9rXOv/c3r17D5/zb2EhYOELnY//J+2/5DZ2igRDxLXQ7P8UMwr8y//rfKjd2zqpHD9+/KMp/xqNgIW7VU/H/5s2fMT/nguf4nQ1eBVzs8GrODMtLjCuwP+i6dzhUXds30Dt6qP29ezqk8DXn2ydNJ7af3Dpt2UQ4GOmAD7JFv/JgK8Arwa8BbwW8Bbw4hTAA+8Z8FrAW8BrxcEneKsh4HMIn+S9xYAH3jfgtdjVW8BrcXBnAS9OATzwngGvBbwFvBbwFvDiFMAD7xnwWsBbwGsBbwEvTgE88J4BrwW8BbxWBHz83TMXpgA+V/BJ7pHtTgE88J4Br7XR8AmnAD5X8MmnAB54z4DXAt4CXgt4C3hxCuCB9wx4LeAt4LWAt4AXpwAeeM+A1wLeAl4LeAt4cQrgcwKf+H65C1MAnw/4UuJ74i9MATzwngGvxa7eAl6LgzsLeHEK4IH3DHgt4C3gtYC3+gwf8F4a6/DWJNPr8KYg6/AGKeqbgqwxRfhbk8hTSG9Nwha/RoXc4gMmBd4CXgt4C3hxCuCB9wx4LeAt4LWAt4AXpwAeeM+A1wLeAl4LeAt4cQrggfcMeK11h9cebLc0BfCDDi8+vHZpCuCB9wx4rQ2A95kC+EGH95wCeOA9A14LeAt4LeCtdYbffVn7YBn4qHIJf8XLbPFx5RL+ukXg48ol/FMPzAAfUy7hO68zwHV8ZLmEjwn4CvBqwFvZg5++7apNt1aBjyqX8FvuHBu/4zbgo8ol/DVzzjU2Ax8V8FrAW9mD37JtfHzbVuCjyiX89NZNm7ZMAx9VLuFjAr6SR/jS3dxyl6D8wbPFJyqX8Ne3/jt3LfBR5RD+xu6e/ibgo8ohvHO39DQHfqlcwrc7fyvwUeUS/oFPtXb13wA+qlzCX3301pMHHgQ+qlzCX97c//ziV4CPKpfwX33w8PfevCrb8F7Pmbs4BfBrwj973cK3P/1IpuH9niV7cQrg14SPCfgK8GrAWxmDLy219IXm/eXyoZnh/cMzGYKvhFzFA59oi58aaZ2MHHFHRrIEHxTwSeDf23Pfo2O7aq62G3grl/Ard/UnXp8/tG970zW3tz45MDQ0FP2USspysys/Xb3Fz+w4uOyz2r07666+s3VuvtFoVE/5V68HLNxtYiJ4FfVaFqaYnQlexeS4uMDJOHhnt9wdHnXH9j0z6o5yHb+sXO7q271y5dK5xlP7D47PPDH8ZKaO6oMCfm349jX8pTtX/zIAb+USPibgK8CrAW9lD/6DW668/JsngI8ql/A33DM5fc/XgI8ql/BXnXfu3Cbgo8ol/I6fHD/+47uBjyqX8Ev3z/0S+J7lEj4m4CvAqwFvZQ+eFz+KL5fwvPhRfLmE5zVw4gNeC3gre/C8+FF8uYTnxY/iyyV8TMBXcgrPvXPx5RKee+fiyyU8987Fl0t47p2LL5fw3DsXXy7hY0oRvv3rCLwFvDgF8MB7BrxW6HV8qcR1/LKKA1/h4G55wItTAA+8Z8BrAW8BrwW8Bbw4BfDAewa8FvAW8FrAW8CLUwAPvGfAawFvAa8FvAW8OAXwwHsGvBbwFvBawFvAi1MAD7xnwGsBbwGvBbwFvDgF8F7wU/41GgELd5uuBq9iLnyK6nT4FLP9n2KcLT6wQm7xAZMCbwGvBbwFvDgF8MB7BrwW8BbwWsBbwItTAA+8Z8BrAW8BrwW8Bbw4BfDAewa8FvAW8FrAWzmHL5VKyz4D3so3fAn4XgEvTgH8IMBXVrgDv6ycw68MeAt4cQrggfcMeC3gLeC1gLeAF6cAHnjPgNcC3gJeC3gLeHEK4IH3DHgt4C3gtYC3gBenAB54z4DXAt4CXgt4C3hxCuCB9wx4LeAt4LWAt4AXpwAeeM+A1wLeAl4LeAt4cQrggfcMeC3gLeC1gLc2FL757IE9x5v3l8uHgLcKAP/+C+7Dh6ZG2OJXVAD4UxNu6uH39tz36FgbvVqtTo75V68HLNxtcip4FbPhU0yF/BS6NWrBq5ieEBc4JcA7V3nk7ROvzx/a1zr7xI4dO/664N/iYsDCS+sIX8M6rCJ4DalMURfgFw891vk9qd3Lrt4qwK7+2NMLzh0edcf2AW8VAP7FXeVyufHU/oNLb10FfKUQ8KsCvgK8GvAW8FrAW8CLUwAPvGfAawFvAb9GK1++dkXAW7mDLwGfKODFKYDPKHyltzvwy8offETAW8CLUwAPvGfAawFvAa8FvAW8OAXwwHsGvBbwFvBawFvAi1MAD7xnwGsBbwGvBbwFvDgF8MB7BrwW8BbwWsBbwItTAA+8Z8BrAW8BrwW8Bbw4BfDAewa8FvAW8FrAW8CLUwAPvGfAawFvAa8FvAW8OAXwwHsGvBbwFvBawFvAi1MAD7xnwGsBbwGvBbw18PARr262KuCtPsNP+ddorPnl9uvaJV3FdDXg8rvNrT2FUnU6fIrZ/k8xvpIyC1t84k2eLd5iVy9OAXxG4JWAt4AXpwAeeM+A1wLeAl4LeAt4cQrggfcMeC3gLeC1gLeAF6cAHnjPgNcC3gJeC3gLeHEK4IH3DHgt4C3gtYC3gBenAB54z4DXAt4CXgt4C3hxCuCB9wx4LeAt4LWAt4AXpwAeeM+A1xKeI9cr4K2BgVeeFdsr4C3gtYAH3jfgtTi4s4DXAt4CXpwCeOA9A14LeAt4LeAt4MUpgAfeM+C1gLeA1wLeAl6cAnjgPQO+U+L7XoC3cgKfTB54C3gt4K2Nh58Z3j88Ewmf7HKBtwYCfuSIOzLSGz5xwFsDAb+r5mq7Wx9PvPXWW/+t+jc3F7BwtzNngleRjSnmG8GrOHtaXGBChd/edM3trY9/ePzxx9+Y96/ZDFi428cfB68iI1Oc7/8UZ1T4nXVX33nhPLv6SnF29c+MuqNcxy+rKPAzTww/GXFUnzjgrYGAX/FLEDAp8BbwWsBbwItTAA+8Z8BrAW8BrwW8Bbw4BfDAewa8FvAW8FrAW8CLUwAPvGfAa42+EbBwt5Mng1fxxmjwKk7JP/JVHflH+BTyzyIEPqQ//6lvFxXRS39Je4J2v3s17QmATyXg+x7wF+of/Oho3y4qor//I+0J2h1+M+0J+ghPmQr4ggZ8QesbfPPZA3uO9+vCevbHfXvSv3p1buzetCfoH/z7L7gPH+rXhfVq6uDixM/SHsK5xq+G0h6hf/CnJtzUw/26sF7NV8//55G0h3ALv6kWCN65yiNv9+/CevXboffTHsG9cswVCH7x0GOn+nVZvYdYXHwn9d2O+/nQ0NBP0x6ib/DHnl7o10X17v1n3MQDaQ/RrkBb/Iu7yuVyvy6sV83n9pb/nfYQ7QoET9kK+IIGfEErMPyqb710ySWX3fDqWv8nhxXhe+zRanjnZp6+6qhzdy995cb+TtTPgP/EF/Z8J+qf5Kccf2txldz01s2fvXXanb39mi8dLF34WXzwhc6ZA5s3PexuKV2f8owbV6Hht97RaGz7vrvr9tm5u5bg5y7tnPnMv979eq5/Ojn+1uIquU3jzo1d7a5uf7i4xX++c+ZbNz99Ptc/nRx/a3G14CecG9/U+TBZWnYd3zqz+NJ32eJzWsltuXOusW2ru21bY+4HXfiZX7eP6ltnPvfuO1e0zpxLe8gNq9DwU1uu2dw6uKtu2fTl4ctX/h1fvvLq/c7ddG3aQ25YBYa/2HMfOnfsi2lP0eeAd+6HN49/dMuP0p6izwHvXG3L5ZvvqqU9RZ8DvqABX9CAL2jAFzTgCxrwBQ34ggZ8Qfs/5uz4c61dfwsAAAAASUVORK5CYII=" alt="plot of chunk percPopulation"/> </p>

</body>

</html>
